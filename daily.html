<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>ì¼ì¼ ì—…ë¬´ ë³´ê³ </title>

<style>
body{
  margin:0;
  background: radial-gradient(circle at 50% 20%, #0f172a, #020617 70%);
  font-family: "Segoe UI", Arial, sans-serif;
  color:#e5e7eb;
  padding-top:80px;
}

.container{
  width:900px;
  margin:40px auto;
}

/* ìƒë‹¨ ì¹´ë“œ */
.header{
  background:rgba(25,35,60,0.6);
  border-radius:18px;
  padding:25px;
  box-shadow:0 0 25px rgba(0,0,0,.4);
}

.header-top{
  display:flex;
  justify-content:space-between;
  align-items:center;
}

.percent{
  font-size:34px;
  font-weight:bold;
  color:#60a5fa;
}

.progress-wrap{
  margin-top:12px;
  height:8px;
  background:#1f2937;
  border-radius:8px;
  overflow:hidden;
}

#progressBar{
  height:100%;
  width:0%;
  background:linear-gradient(90deg,#3b82f6,#60a5fa);
  transition:.25s;
}

/* ë²„íŠ¼ */
.controls{
  margin-top:15px;
}

.btn{
  display:inline-block;
  padding:6px 14px;
  border-radius:20px;
  background:#1f2937;
  border:1px solid #374151;
  cursor:pointer;
  transition:.2s;
  margin-right:8px;
}

.btn:hover{
  background:#2c3b55;
  transform:translateY(-2px);
}

.btn.active-hide{
  border-color:#34d399;
  color:#34d399;
  background:rgba(52,211,153,0.15);
}

.excludeViewBtn.active-hide{
  border-color:#34d399;
  color:#34d399;
  background:rgba(52,211,153,0.15);
}

.btn.active{
  background:#3b82f6;
  border:none;
}

/* ì¹´í…Œê³ ë¦¬ */
.category-title{
  margin-top:30px;
  margin-bottom:10px;
  color:#34d399;
  font-weight:bold;
}

/* ê·¸ë£¹ ì¹´ë“œ */
.group{
  background:rgba(30,41,59,0.6);
  border-radius:14px;
  margin-bottom:14px;
  overflow:hidden;
}

.group-header{
  padding:15px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  cursor:pointer;
}

.group-info{
  margin-left:10px;
}

.group-title{
  font-weight:600;
}

.group-desc{
  font-size:12px;
  opacity:.6;
}

.group-count{
  border:1px solid #334155;
  padding:4px 10px;
  border-radius:8px;
  font-size:12px;
}

/* í•˜ìœ„ ëª©ë¡ */
.group-items{
  max-height:0;
  overflow:hidden;
  transition:.25s;
  border-top:1px dashed #334155;
}

.group.open .group-items{
  max-height:500px;
}

.sub-item{
  display:flex;
  align-items:center;
  gap:8px;
  padding:10px 20px;
  font-size:14px;
}

.sub-item input{
  width:16px;
  height:16px;
}

.hide-completed .group.done{
  display:none;
}
.group.done{
  background:linear-gradient(180deg, rgba(16,185,129,0.25), rgba(30,41,59,0.6));
  box-shadow:0 0 12px rgba(16,185,129,0.35);
  border:1px solid rgba(16,185,129,0.6);
}

/* ì™„ë£Œëœ ê·¸ë£¹ ì œëª© ê°•ì¡° */
.group.done .group-title{
  color:#34d399;
  text-decoration:line-through;
}

/* ì¹´ìš´íŠ¸ ë°•ìŠ¤ ê°•ì¡° */
.group.done .group-count{
  border-color:#34d399;
  color:#34d399;
  font-weight:bold;
}
.sub-item.completed{
  opacity:.45;
  text-decoration:line-through;
}
.group-check{
   width:22px;
  height:22px;
}
.top-nav{
  display:flex;
  gap:12px;
  justify-content:center;
  margin-bottom:20px;
}

.excluded-group{
  display:none !important;
}

.top-header{
  position:fixed;        /* â­ í•µì‹¬ (ê³ ì •) */
  top:0;
  left:0;
  width:100%;
  height:72px;
  z-index:9999;          /* ì¹´ë“œ ìœ„ì— í•­ìƒ ë³´ì´ê²Œ */

  display:flex;
  align-items:center;
  justify-content:center;

  background:linear-gradient(to bottom, rgba(2,6,23,.98), rgba(2,6,23,.65));
  border-bottom:1px solid rgba(96,165,250,.25);
  box-shadow:0 6px 35px rgba(0,0,0,.8);
  backdrop-filter: blur(8px); /* â­ ìœ ë¦¬ ëŠë‚Œ */
}

.top-header.scrolled{
  background:linear-gradient(to bottom, rgba(2,6,23,1), rgba(2,6,23,.85));
  box-shadow:0 8px 40px rgba(0,0,0,1);
}

/* ì¤‘ì•™ íƒ€ì´í‹€ */
.top-header .title{
  font-size:28px;
  font-weight:800;
  letter-spacing:2px;
  color:#93c5fd;
  text-shadow:
    0 0 10px rgba(96,165,250,.8),
    0 0 25px rgba(37,99,235,.6);
}

.back-btn{
  left:18px;
  top:50%;
  transform:translateY(-50%);
  padding:8px 14px;
  border-radius:10px;
  border:1px solid rgba(96,165,250,.5);
  background:rgba(30,41,59,.55);
  color:#bfdbfe;
  font-size:14px;
  font-weight:600;
  cursor:pointer;
  transition:.2s;
  backdrop-filter: blur(6px);
}

/* hover íš¨ê³¼ */
.back-btn:hover{
  background:#3b82f6;
  color:white;
  border-color:#60a5fa;
  box-shadow:0 0 12px rgba(96,165,250,.8);
  transform:translateY(-50%) scale(1.05);
}

/* í´ë¦­ */
.back-btn.active{
  background:#3b82f6;
  color:white;
  border-color:#60a5fa;
  box-shadow:0 0 12px rgba(96,165,250,.9);
  transform:translateY(-50%) scale(.96);
 
}
</style>
</head>

<body>
  <div class="top-header">
  <button class="back-btn" onclick="goPage('index')">ğŸ§® ê¸°ì§ˆ íŒŒë°</button>
  <button class="back-btn" onclick="goPage('daily')">ğŸ“‹ ì²´í¬ë¦¬ìŠ¤íŠ¸</button>
</div>

<div class="container">

<!-- ìƒë‹¨ -->
<div class="header">
  <div class="header-top">
    <div>
      <div style="font-size:22px;font-weight:600">â€¼ï¸ê´€ë¦¬ì ì²´í¬ë¦¬ìŠ¤íŠ¸â€¼ï¸</div>
      <div id="date"></div>
    </div>
    <div class="percent" id="percent">0%</div>
  </div>

  <div class="progress-wrap">
    <div id="progressBar"></div>
  </div>

  <div class="controls">
    <span class="btn" id="hideBtn">ìˆ¨ê¹€ Off</span>
        <span class="btn" id="excludeViewBtn">ì œì™¸ ë³´ê¸° OFF</span>
    <span class="btn" id="resetBtn">ì „ì²´ í•´ì œ</span>
  </div>
</div>


<!-- ì¹´í…Œê³ ë¦¬ -->
<div class="category-title">â— ì§€ì—­ ê±´ì„¤</div>

<div class="group">
  <div class="group-header">
    <div style="display:flex;align-items:center;">
      <input type="checkbox" class="group-check">
      <div class="group-info">
        <div class="group-title">ê±°ì  ê´€ë¦¬</div>
        <div class="group-desc">ê³µì¥ ìƒì‚°í’ˆìœ¼ë¡œ ê´€ë¦¬ê¶Œ êµí™˜í•˜ê¸°</div>
      </div>
    </div>
    <div class="group-count">0/2</div>
  </div>

  <div class="group-items">
    <label class="sub-item">
      <input type="checkbox" class="task"> 4ë²ˆ í˜‘ê³¡ ê´€ë¦¬ê¶Œ êµí™˜
    </label>
    <label class="sub-item">
      <input type="checkbox" class="task"> ë¬´ë¦‰ ê´€ë¦¬ê¶Œ êµí™˜
    </label>
  </div>

</div>


<div class="group">
  <div class="group-header">
    <div style="display:flex;align-items:center;">
      <input type="checkbox" class="group-check">
      <div class="group-info">
        <div class="group-title">ë¬¼ì ê´€ë¦¬</div>
        <div class="group-desc">ë¬´íŠ¸ì½”ì¸</div>
      </div>
    </div>
    <div class="group-count">0/2</div>
  </div>

  <div class="group-items">
    <label class="sub-item">
      <input type="checkbox" class="task"> 4ë²ˆ í˜‘ê³¡ ë³€ë™ë¬¼ì
    </label>
    <label class="sub-item">
      <input type="checkbox" class="task"> ë¬´ë¦‰ ë³€ë™ë¬¼ì
    </label>
  </div>

</div>
<div class="group">
  <div class="group-header">
    <div style="display:flex;align-items:center;">
      <input type="checkbox" class="group-check">
      <div class="group-info">
        <div class="group-title">ì €ì¥ê³  ë…¸ë“œ</div>
        <div class="group-desc">ë°°ë‹¬ì˜ ë¯¼ì¡± ì£¼ë¬¸~</div>
      </div>
    </div>
    <div class="group-count">0/4</div>
  </div>

  <div class="group-items">
    <label class="sub-item">
      <input type="checkbox" class="task"> ì˜¤ë¦¬ì§€ëŠ„ ì—°êµ¬ êµ¬ì—­
    </label>
    <label class="sub-item">
      <input type="checkbox" class="task"> ê´‘ë§¥ êµ¬ì—­
    </label>
    <label class="sub-item">
      <input type="checkbox" class="task"> ì—ë„ˆì§€ ê³µê¸‰ ê³ ì§€
    </label>
    <label class="sub-item">
      <input type="checkbox" class="task"> ë¬´ë¦‰ì„± ë„ì‹¬
    </label>
  </div>
</div>
  <div class="category-title">â— ì¼ì¼ ìˆ˜ë ¹</div>

<div class="group">
  <div class="group-header">
    <div style="display:flex;align-items:center;">
      <input type="checkbox" class="group-check">
      <div class="group-info">
        <div class="group-title">ìƒì </div>
        <div class="group-desc">ë§¤ì¼ë§¤ì¼ ê¼­ í• ê²ƒ! </div>
      </div>
    </div>
    <div class="group-count">0/4</div>
  </div>
  <div class="group-items">
    <label class="sub-item">
      <input type="checkbox" class="task"> í¬ë ˆë”§ ê±°ë˜ì†Œ
    </label>
  </div>
</div>

<div class="group">
  <div class="group-header">
    <div style="display:flex;align-items:center;">
      <input type="checkbox" class="group-check">
      <div class="group-info">
        <div class="group-title">ì¬í™œìš© ì„¼í„°</div>
        <div class="group-desc">ì¼ê´„ìˆ˜ë ¹ ê¸‰í•¨! </div>
      </div>
    </div>
    <div class="group-count">0/8</div>
  </div>
  <div class="group-items">
    <label class="sub-item">
      <input type="checkbox" class="task"> í˜‘ê³¡ê¸¸
    </label>
    <label class="sub-item">
      <input type="checkbox" class="task"> ê±°ì ì§€ì—­
    </label>
    <label class="sub-item">
      <input type="checkbox" class="task"> ì•„ë¶€ë ˆì´ ì±„ì„ì¥
    </label>
    <label class="sub-item">
      <input type="checkbox" class="task"> ì˜¤ë¦¬ì§€ëŠ„ ì—°êµ¬ êµ¬ì—­
    </label>
    <label class="sub-item">
      <input type="checkbox" class="task"> ê´‘ë§¥ êµ¬ì—­
    </label>
    <label class="sub-item">
      <input type="checkbox" class="task"> ì—ë„ˆì§€ ê³µê¸‰ ê³ ì§€
    </label>
    <label class="sub-item">
      <input type="checkbox" class="task"> ë¬´ë¦‰ì„±
    </label>
    <label class="sub-item">
      <input type="checkbox" class="task"> ê²½ì˜¥ ê³¨ì§œê¸°
    </label>
  </div>
</div>

<div class="group">
  <div class="group-header">
    <div style="display:flex;align-items:center;">
      <input type="checkbox" class="group-check">
      <div class="group-info">
        <div class="group-title">í•„ìˆ˜ í•­ëª©</div>
        <div class="group-desc">ë§¤ì¼ë§¤ì¼ í™•ì¸ í• ê²ƒ! </div>
      </div>
    </div>
    <div class="group-count">0/2</div>
  </div>
  <div class="group-items">
    <label class="sub-item">
      <input type="checkbox" class="task"> ì¼ì¼ í™œì•½ë„ 100
    </label>
    <label class="sub-item">
      <input type="checkbox" class="task"> ì´ì„± ì†Œëª¨(ë³¸ì¸ ê¸°ì¤€ ì—¬ìœ ë¡œìš°ë©´ ì²´í¬)
    </label>
  </div>
</div>

<div class="group">
  <div class="group-header">
    <div style="display:flex;align-items:center;">
      <input type="checkbox" class="group-check">
      <div class="group-info">
        <div class="group-title">ì œì‘ ì¬ë£Œ</div>
        <div class="group-desc">í•˜ëŠ” ì‚¬ëŒë§Œ? </div>
      </div>
    </div>
    <div class="group-count">0/2</div>
  </div>
  <div class="group-items">
    <label class="sub-item">
      <input type="checkbox" class="task"> ë†ì‘ë¬¼ ìˆ˜í™•
    </label>
    <label class="sub-item">
      <input type="checkbox" class="task"> ë¹„ë£Œ ì¬ë£Œ ìˆ˜ì§‘
    </label>
  </div>
</div>

<div class="group">
  <div class="group-header">
    <div style="display:flex;align-items:center;">
      <input type="checkbox" class="group-check">
      <div class="group-info">
        <div class="group-title">ì œê°•í˜¸</div>
        <div class="group-desc">ë‚˜ì—¬! ê´€ë¦¬ì! </div>
      </div>
    </div>
    <div class="group-count">0/2</div>
  </div>
  <div class="group-items">
    <label class="sub-item">
      <input type="checkbox" class="task"> ì •ë³´ êµë¥˜ 5íšŒ
    </label>
    <label class="sub-item">
      <input type="checkbox" class="task"> ìƒì‚° ì§€ì› 5íšŒ
    </label>
    <label class="sub-item">
      <input type="checkbox" class="task"> ì œê°•í˜¸ ê´€ë¦¬
    </label>
  </div>
</div>

</div> 

<script>

  let showExcluded = false; // í™”ë©´ í‘œì‹œ ìƒíƒœ (ë³´ê¸°ìš©)
  let excludedGroups = new Set(JSON.parse(localStorage.getItem("excludedGroups")||"[]"));

function goPage(page){

  // GAS ì›¹ì•±ì¸ì§€ í™•ì¸
  if (location.hostname.includes("script.google.com")) {

    // í˜„ì¬ URL ìœ ì§€í•˜ë©´ì„œ page íŒŒë¼ë¯¸í„°ë§Œ êµì²´
    const url = new URL(window.location.href);
    url.searchParams.set('page', page);
    window.location.replace(url.toString());

  } else {

    // GitHub Pages (ì •ì  html ì´ë™)
    window.location.href = page + ".html";

  }
}


/* ë‚ ì§œ */
document.getElementById("date").textContent = 
  new Date().toLocaleDateString("ko-KR", {
    year: 'numeric',
    month: 'long',
    day: 'numeric',
    weekday: 'long' // "ì›”ìš”ì¼"ê¹Œì§€ í‘œì‹œ
});

document.querySelectorAll(".group").forEach((group,i)=>{

  const id = "group_" + i;
  group.dataset.groupId = id;

  // ìš°í´ë¦­ â†’ ì œì™¸ í† ê¸€
  group.addEventListener("contextmenu", e=>{
    e.preventDefault();

    if(e.target.tagName === "INPUT") return;

    if(excludedGroups.has(id)){
      excludedGroups.delete(id);
    }else{
      excludedGroups.add(id);
    }

    localStorage.setItem("excludedGroups", JSON.stringify([...excludedGroups]));

    applyExcludedVisibility();
    updateAll();
  });

});

/* ìƒìœ„ ì²´í¬ â†’ í•˜ìœ„ ì „ì²´ ì²´í¬ */
document.querySelectorAll(".group-check").forEach(groupCheck=>{
  groupCheck.addEventListener("change", e=>{
    const group = e.target.closest(".group");
    const tasks = group.querySelectorAll(".task");

    tasks.forEach(t=>{
      t.checked = e.target.checked;
      t.parentElement.classList.toggle("completed", t.checked);
    });

    updateAll();
    saveState();
  });
});


/* í•˜ìœ„ ì²´í¬ â†’ ìƒìœ„ ì²´í¬ ìƒíƒœ ë°˜ì˜ */
document.addEventListener("change", e=>{
  if(!e.target.classList.contains("task")) return;

  const group = e.target.closest(".group");
  const tasks = group.querySelectorAll(".task");
  const checked = group.querySelectorAll(".task:checked");
  const groupCheck = group.querySelector(".group-check");

  groupCheck.checked = (tasks.length === checked.length);

  e.target.parentElement.classList.toggle("completed", e.target.checked);

  updateAll();
  saveState();
});

const excludeViewBtn = document.getElementById("excludeViewBtn");

excludeViewBtn.onclick = ()=>{
  showExcluded = !showExcluded;

  excludeViewBtn.textContent =
    showExcluded ? "ì œì™¸ ë³´ê¸° ON" : "ì œì™¸ ë³´ê¸° OFF";

  excludeViewBtn.classList.toggle("active-hide");

  applyExcludedVisibility();
};

function applyExcludedVisibility(){

  document.querySelectorAll(".group").forEach(group=>{
    const id = group.dataset.groupId;

    if(excludedGroups.has(id)){
      // ì œì™¸ëœ ê·¸ë£¹
      if(showExcluded){
        group.style.display = "";      // ë³´ê¸° ON â†’ ë³´ì—¬ì¤Œ
        group.style.opacity = "0.35";  // êµ¬ë¶„ìš© íë¦¼
      }else{
        group.style.display = "none";  // ë³´ê¸° OFF â†’ ìˆ¨ê¹€
      }
    }else{
      // ì •ìƒ ê·¸ë£¹
      group.style.display = "";
      group.style.opacity = "1";
    }
  });

}

function saveState(){
  const states = [];

  document.querySelectorAll(".task").forEach((t,i)=>{
    states[i] = t.checked;
  });

  localStorage.setItem("dailyChecklist", JSON.stringify(states));
}

/* ê·¸ë£¹ ì¹´ìš´íŠ¸ + ì „ì²´ ì§„í–‰ë¥  */
function updateAll(){

  let total = 0;
  let done = 0;

  document.querySelectorAll(".group").forEach(group=>{

    const groupId = group.dataset.groupId;

    // â˜… ì œì™¸ëœ ê·¸ë£¹ì€ í¼ì„¼íŠ¸ ê³„ì‚°ì—ì„œ ì™„ì „ ì œì™¸
    if(excludedGroups.has(groupId)){
      group.querySelector(".group-count").textContent = "-/-";
      group.classList.remove("done");
      return;
    }

    const tasks = group.querySelectorAll(".task");
    const checked = group.querySelectorAll(".task:checked");

    group.querySelector(".group-count").textContent =
      `${checked.length}/${tasks.length}`;

    if(tasks.length === checked.length && tasks.length !== 0){
      group.classList.add("done");
    }else{
      group.classList.remove("done");
    }

    total += tasks.length;
    done += checked.length;
  });

  const percent = total ? Math.round(done/total*100) : 0;

  document.getElementById("percent").textContent = percent+"%";
  document.getElementById("progressBar").style.width = percent+"%";
}

/* ì•„ì½”ë””ì–¸ */
document.querySelectorAll(".group-header").forEach(header=>{
  header.addEventListener("click", e=>{
    if(e.target.tagName === "INPUT") return;
    header.parentElement.classList.toggle("open");
  });
});


/* ì™„ë£Œ ìˆ¨ê¸°ê¸° */
let hide=false;
const hideBtn=document.getElementById("hideBtn");

hideBtn.onclick=()=>{
  hide=!hide;
  document.body.classList.toggle("hide-completed");

  hideBtn.textContent = hide?"ìˆ¨ê¹€ On":"ìˆ¨ê¹€ Off";
  hideBtn.classList.toggle("active-hide", hide);
};
document.getElementById("resetBtn").onclick = () => {

  // 1. ëª¨ë“  í•˜ìœ„ ì²´í¬ í•´ì œ
  document.querySelectorAll(".task").forEach(t=>{
    t.checked = false;
    t.parentElement.classList.remove("completed");
  });

  // 2. ëª¨ë“  ê·¸ë£¹ ì²´í¬ í•´ì œ
  document.querySelectorAll(".group-check").forEach(g=>{
    g.checked = false;
  });

  // 3. ê·¸ë£¹ ì™„ë£Œ í‘œì‹œ ì œê±°
  document.querySelectorAll(".group").forEach(group=>{
    group.classList.remove("done");
  });
  localStorage.removeItem("dailyChecklist");
updateAll();
};

function loadState(){
  const saved = localStorage.getItem("dailyChecklist");
  if(!saved) return;

  const states = JSON.parse(saved);

  // 1ï¸âƒ£ í•˜ìœ„ ì²´í¬ ë³µì›
  document.querySelectorAll(".task").forEach((t,i)=>{
    if(states[i]){
      t.checked = true;
      t.parentElement.classList.add("completed");
    }
  });

  // 2ï¸âƒ£ ê·¸ë£¹ ì²´í¬ ìƒíƒœ ì¬ê³„ì‚° (ì—¬ê¸°ê°€ í•µì‹¬)
  document.querySelectorAll(".group").forEach(group=>{
    const tasks = group.querySelectorAll(".task");
    const checked = group.querySelectorAll(".task:checked");
    const groupCheck = group.querySelector(".group-check");

    if(groupCheck){
      groupCheck.checked = (tasks.length > 0 && tasks.length === checked.length);
    }
  });

  updateAll();
}
loadState();

window.addEventListener("DOMContentLoaded", () => {
  const header = document.querySelector(".top-header");
  if(!header) return;

  window.addEventListener("scroll", () => {
    if(window.scrollY > 10){
      header.classList.add("scrolled");
    }else{
      header.classList.remove("scrolled");
    }
  });
});

function setActiveTab(){

  let currentPage = "index";

  // 1ï¸âƒ£ GAS : ?page=
  const params = new URLSearchParams(window.location.search);
  const paramPage = params.get("page");

  if(paramPage){
    currentPage = paramPage;
  }
  else{
    // 2ï¸âƒ£ GitHub Pages íŒŒì¼ëª… íŒë³„
    const href = location.href.toLowerCase();

    if(href.includes("daily")) currentPage = "daily";
    else  currentPage = "index";
  }

  // ë²„íŠ¼ active ì ìš©
  document.querySelectorAll(".back-btn").forEach(btn=>{
    btn.classList.remove("active");

    const onclick = btn.getAttribute("onclick");
    if(!onclick) return;

    if(onclick.includes(currentPage)){
      btn.classList.add("active");
    }
  });
}

/* GAS ëŒ€ì‘ + ì¼ë°˜ì›¹ ëŒ€ì‘ */
document.addEventListener("DOMContentLoaded", setActiveTab);

</script>

</body>
</html>
